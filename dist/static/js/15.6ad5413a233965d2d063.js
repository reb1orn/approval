webpackJsonp([15,47],{36:function(e,t,i){e.exports={default:i(38),__esModule:!0}},38:function(e,t,i){var a=i(32),o=a.JSON||(a.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},436:function(e,t,i){(function(e){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=i(36),s=a(o),n=i(19),d=a(n),l=i(8);i(107),t.default={name:"set",data:function(){return{isActive_1:!0,isActive_2:!1,oid:"ff80808159956936015995e711f40086",uid:"b7dbe60745954de4bf75e1c6a755ad8e",TOKEN:"",loading:!1}},created:function(){void 0!=sessionStorage.getItem("orgId")&&(this.oid=sessionStorage.getItem("orgId"),this.uid=sessionStorage.getItem("userId"),this.TOKEN=sessionStorage.getItem("accessToken"))},watch:{},methods:(0,d.default)({addAddresslist:function(){this.isActive_1=!0,this.isActive_2=!1},exportAddresslist:function(){this.isActive_1=!1,this.isActive_2=!0},goAddresslist:function(){this.$router.push({path:"/home/addresslist"})},templetDownClick:function(){window.location.href=e.ip+"/api-org/book/download/"+this.oid+"/"+this.uid+"?access_token="+this.TOKEN},memberInfoExcelClick:function(){window.location.href=e.ip+"/api-org/book/export/"+this.oid+"/"+this.uid+"?access_token="+this.TOKEN},onFileChange:function(e){var t=this,i=e.target.files||e.dataTransfer.files,a=i[0];a.name.lastIndexOf(".xls")==-1&&a.name.lastIndexOf(".xlsx")==-1?this.$message("暂支持.xls,.xlsx格式，请重新上传"):t.uploadImage(i[0])},uploadImage:function(e){var t=this,i=this;i.loading=!0;var a=new FormData;a.append("file",e),this.uploadFileExcel(a).then(function(e){if(i.loading=!1,"000000"==e.code){t.$message({message:"上传文件成功",type:"success"});var a=(0,s.default)(e.data);sessionStorage.setItem("excelData",a),i.$router.push({path:"/home/excelList"}),document.getElementById("upload_1").value="",document.getElementById("upload_2").value=""}else t.$message(e.msg),document.getElementById("upload_1").value="",document.getElementById("upload_2").value=""}).catch(function(e){document.getElementById("upload_1").value="",document.getElementById("upload_2").value="",i.loading=!1,"188888"==JSON.parse(e.bodyText).code?(t.$message({type:"info",message:JSON.parse(e.bodyText).msg}),t.$router.push({path:"/login"})):t.$message({type:"info",message:"服务器错误!"})})}},(0,l.mapActions)(["uploadFileExcel"])),mounted:function(){}}}).call(t,function(){return this}())},781:function(e,t,i){t=e.exports=i(6)(),t.push([e.id,".active[data-v-76fbe568]{background-color:rgba(228,74,17,.6);color:#fff}input[type=file][data-v-76fbe568]{display:none}label[data-v-76fbe568]{margin-bottom:0;font-weight:400;color:#fff;width:68px;height:30px;line-height:30px;border-radius:4px;background-color:#e7744a;margin-left:5px;text-align:center;cursor:pointer}.excelUpload[data-v-76fbe568]{width:1008px;margin:0 auto;padding:0 20px}.excelUpload>div[data-v-76fbe568]:first-child{margin:30px 0}.excelUpload>div:first-child > span[data-v-76fbe568]:nth-child(1){color:#e7744a;cursor:pointer}.excelUpload>div[data-v-76fbe568]:nth-child(2){display:-ms-flexbox;display:flex}.excelUpload>div:nth-child(2) p a[data-v-76fbe568],.excelUpload>div:nth-child(2) p span[data-v-76fbe568]{color:#e7744a}.excelUpload>div:nth-child(2) p a[data-v-76fbe568]:hover{text-decoration:none}.excelUpload>div[data-v-76fbe568]:nth-child(3){height:115px;border-radius:4px;background-color:#fbfaea;border:1px solid #efeedc;padding-left:20px;margin-top:20px}.excelUpload>div:nth-child(3) p a[data-v-76fbe568]{color:#e7744a;cursor:pointer}.excelUpload>div:nth-child(3) h2[data-v-76fbe568]{font-size:14px;margin:12px 0;margin-bottom:5px}.Butbox[data-v-76fbe568]{display:-ms-flexbox;display:flex;height:44px;line-height:44px;margin-top:30px;margin-bottom:15px;font-size:16px}.Butbox div[data-v-76fbe568]:first-child{border-bottom-left-radius:4px;border-top-left-radius:4px;width:155px;height:44px;text-align:center;border:1px solid #d7d7d7;border-right:none;cursor:pointer}.Butbox div[data-v-76fbe568]:nth-child(2){border-bottom-right-radius:4px;border-top-right-radius:4px;width:155px;height:44px;text-align:center;border:1px solid #d7d7d7;border-left:none;cursor:pointer}.content[data-v-76fbe568]{border-radius:4px;border:1px solid #d7d7d7}.content>div[data-v-76fbe568]{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin:25px}.content>div>div[data-v-76fbe568]:first-child{margin-right:15px}#setMain[data-v-76fbe568]{height:100%;overflow-x:hidden;overflow-y:auto}",""])},1148:function(e,t,i){var a=i(781);"string"==typeof a&&(a=[[e.id,a,""]]);i(7)(a,{});a.locals&&(e.exports=a.locals)},1219:function(e,t,i){i(1148);var a=i(5)(i(436),i(1305),"data-v-76fbe568",null);e.exports=a.exports},1305:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"set",attrs:{id:"setMain","element-loading-text":"上传中...."}},[i("div",{staticClass:"excelUpload"},[i("div",[i("span",{on:{click:e.goAddresslist}},[e._v("通讯录")]),e._v(" "),i("span",[e._v(">导入通讯录")])]),e._v(" "),e._m(0),e._v(" "),i("div",[i("h2",[e._v("提示：")]),e._v(" "),i("p",[e._v("1.如果需要修改员工信息类别，请点击"),i("router-link",{attrs:{to:"/home/set/addresslistInfo"}},[e._v("此处")]),e._v("进行设置，并重新下载模板填写。")],1),e._v(" "),i("p",[e._v("2.为了确保通讯录信息的准确性，请导出通讯录，并在最新通讯录上修改。")]),e._v(" "),i("p",[e._v("3.子账号仅能上传和导出有权限范围内的通讯录信息。")])]),e._v(" "),i("div",{staticClass:"Butbox"},[i("div",{class:{active:e.isActive_1},on:{click:e.addAddresslist}},[e._v("新建通讯录")]),e._v(" "),i("div",{class:{active:e.isActive_2},on:{click:e.exportAddresslist}},[e._v("导出/修改通讯录")])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:1==e.isActive_1,expression:"isActive_1 == true"}],staticClass:"content"},[i("div",[e._m(1),e._v(" "),i("div",[e._v("下载员工通讯录模版，批量填写员工信息")]),e._v(" "),i("label",{on:{click:e.templetDownClick}},[e._v("下载")])]),e._v(" "),i("div",[e._m(2),e._v(" "),i("div",[e._v("上传填写好的员工信息表")]),e._v(" "),i("label",{attrs:{for:"upload_1"}},[e._v("上传")]),e._v(" "),i("input",{attrs:{id:"upload_1",type:"file",accept:".xls,.xlsx"},on:{change:e.onFileChange}})])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:1==e.isActive_2,expression:"isActive_2 == true"}],staticClass:"content"},[i("div",[e._m(3),e._v(" "),i("div",[e._v("导出所有员工信息，批量修改员工信息")]),e._v(" "),i("label",{attrs:{for:"download_2"},on:{click:e.memberInfoExcelClick}},[e._v("导出")])]),e._v(" "),i("div",[e._m(4),e._v(" "),i("div",[e._v("上传修改好的员工信息表")]),e._v(" "),i("label",{attrs:{for:"upload_2"}},[e._v("上传")]),e._v(" "),i("input",{attrs:{id:"upload_2",type:"file",accept:".xls,.xlsx"},on:{change:e.onFileChange}})])])])])},staticRenderFns:[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("span",[e._v("温馨提示：")]),e._v(" "),i("p",[e._v("由于您的企业未认证，通讯录仅能存储"),i("span",[e._v("200人以内")]),e._v("的员工，如有超出，建议"),i("a",[e._v("申请企业认证")])])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("img",{attrs:{src:"/static/img/iconfont_page_step1.png",alt:""}})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("img",{attrs:{src:"/static/img/iconfont_page_step2.png",alt:""}})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("img",{attrs:{src:"/static/img/iconfont_page_step1.png",alt:""}})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("img",{attrs:{src:"/static/img/iconfont_page_step2.png",alt:""}})])}]}}});